

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Memory Reduction for Nodes &mdash; BItShares Developers Portal  documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> BItShares Developers Portal
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Introduction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../intro/architectures.html">Introduction &amp; Architectures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro/environments.html">Development Environments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../components/components.html">System Components Elements</a></li>
</ul>
<p class="caption"><span class="caption-text">Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../development/installation.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bts_guide/accounts/bts_account.html">BitShares Accounts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../development/integration.html">Integration Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../development/interaction.html">Blockchain Interaction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../development/testnets.html">Testnets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../development/bsip.html">BitShares Improvement Proposal</a></li>
<li class="toctree-l1"><a class="reference internal" href="supports.html">Support and Optimizations</a></li>
</ul>
<p class="caption"><span class="caption-text">API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api/api_about.html">1. API Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/restrictions.html">2. API Access and Restrictions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/calls.html">3. Available Calls, Object, and IDs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/blockchain_api.html">4. Blockchain API(s)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/wallet_api.html">5. Wallet API - Calls</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/objects_ids.html">6. Objects and IDs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/namespaces.html">7. Graphene - Namespaces</a></li>
</ul>
<p class="caption"><span class="caption-text">Guides</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../bts_guide/tutorials/index.html">Developer Guide (Tutorials)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bts_guide/index_faq.html">Frequently Asked Questions (FAQ)</a></li>
</ul>
<p class="caption"><span class="caption-text">References</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../references/info_comunities.html">BitShares Community</a></li>
<li class="toctree-l1"><a class="reference internal" href="../references/info_comunities.html#bitshares-blockchain">BitShares Blockchain</a></li>
<li class="toctree-l1"><a class="reference internal" href="../references/tech_articles.html">BitShares Developers’ Contributions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../references/tech_articles.html#articles">Articles</a></li>
<li class="toctree-l1"><a class="reference internal" href="../references/githubrepo.html">BitShares Repositories</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">BItShares Developers Portal</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Memory Reduction for Nodes</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="memory-reduction-for-nodes">
<span id="memory-nodes"></span><h1>Memory Reduction for Nodes<a class="headerlink" href="#memory-reduction-for-nodes" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="table-of-contents">
<p class="topic-title first">Table of Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#four-new-options-to-reduce-ram" id="id1">Four New Options to Reduce RAM</a><ul>
<li><a class="reference internal" href="#programs-witness-node-witness-node-help" id="id2">programs/witness_node/witness_node –help</a></li>
<li><a class="reference internal" href="#options-for-plugin-accout-history" id="id3">Options for plugin accout_history</a></li>
<li><a class="reference internal" href="#plugins" id="id4">–plugins</a></li>
<li><a class="reference internal" href="#track-account" id="id5">–track-account</a></li>
<li><a class="reference internal" href="#max-ops-per-account" id="id6">–max-ops-per-account</a></li>
<li><a class="reference internal" href="#partial-operations" id="id7">–partial-operations</a></li>
</ul>
</li>
<li><a class="reference internal" href="#combinations" id="id8">Combinations</a><ul>
<li><a class="reference internal" href="#special-notes" id="id9">Special Notes</a></li>
</ul>
</li>
</ul>
</div>
<hr class="docutils" />
<div class="section" id="four-new-options-to-reduce-ram">
<h2><a class="toc-backref" href="#id1">Four New Options to Reduce RAM</a><a class="headerlink" href="#four-new-options-to-reduce-ram" title="Permalink to this headline">¶</a></h2>
<div class="section" id="programs-witness-node-witness-node-help">
<h3><a class="toc-backref" href="#id2">programs/witness_node/witness_node –help</a><a class="headerlink" href="#programs-witness-node-witness-node-help" title="Permalink to this headline">¶</a></h3>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">–plugins arg:</th><td class="field-body">Space-separated list of plugins to activate</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="options-for-plugin-accout-history">
<h3><a class="toc-backref" href="#id3">Options for plugin accout_history</a><a class="headerlink" href="#options-for-plugin-accout-history" title="Permalink to this headline">¶</a></h3>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name" colspan="2">–track-account arg:</th></tr>
<tr class="field-odd field"><td>&#160;</td><td class="field-body">Account ID to track history for (may specify multiple times)</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">–max-ops-per-account arg:</th></tr>
<tr class="field-even field"><td>&#160;</td><td class="field-body">Maximum number of operations per account will be kept in memory</td>
</tr>
<tr class="field-odd field"><th class="field-name" colspan="2">–partial-operations arg:</th></tr>
<tr class="field-odd field"><td>&#160;</td><td class="field-body">Keep only those operations in memory that are related to account history tracking</td>
</tr>
</tbody>
</table>
</div>
<hr class="docutils" />
<div class="section" id="plugins">
<h3><a class="toc-backref" href="#id4">–plugins</a><a class="headerlink" href="#plugins" title="Permalink to this headline">¶</a></h3>
<p>Allows to run only the plugins you want.</p>
<p>By default, if the plugin parameter is not present in the command line startup the node will start with the default plugins loaded, these are:</p>
<ul class="simple">
<li>witness</li>
<li>account_history</li>
<li>market_history</li>
</ul>
<p>You can launch a node only with the witness plugin activated like the following if you are after just validating blocks:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">programs</span><span class="o">/</span><span class="n">witness_node</span><span class="o">/</span><span class="n">witness_node</span> <span class="o">--</span><span class="n">data</span><span class="o">-</span><span class="nb">dir</span> <span class="n">data</span><span class="o">/</span><span class="n">my</span><span class="o">-</span><span class="n">blockprod</span>
                                       <span class="o">--</span><span class="n">rpc</span><span class="o">-</span><span class="n">endpoint</span> <span class="s2">&quot;127.0.0.1:8090&quot;</span>
                                                                       <span class="o">--</span><span class="n">plugins</span> <span class="s2">&quot;witness&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="track-account">
<h3><a class="toc-backref" href="#id5">–track-account</a><a class="headerlink" href="#track-account" title="Permalink to this headline">¶</a></h3>
<p>Allows to track only the history of selected accounts.</p>
<p>Suppose you have an application wallet or something that is only interested in the history of one account or just a few accounts, no need to spend the memory in the huge amount of account history from the rest of the network. You will still be able to do transfers and everything as normal, it is just the account history that will not be available.</p>
<p>In order to track the history only for just one account you may start the node as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">programs</span><span class="o">/</span><span class="n">witness_node</span><span class="o">/</span><span class="n">witness_node</span> <span class="o">--</span><span class="n">data</span><span class="o">-</span><span class="nb">dir</span> <span class="n">data</span><span class="o">/</span><span class="n">my</span><span class="o">-</span><span class="n">blockprod</span>
                                       <span class="o">--</span><span class="n">rpc</span><span class="o">-</span><span class="n">endpoint</span> <span class="s2">&quot;127.0.0.1:8090&quot;</span>
                                                                       <span class="o">--</span><span class="n">track</span><span class="o">-</span><span class="n">account</span> <span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">1.2.282</span><span class="se">\&quot;</span><span class="s2">&quot;</span>
</pre></div>
</div>
<p>To track multiple accounts:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">programs</span><span class="o">/</span><span class="n">witness_node</span><span class="o">/</span><span class="n">witness_node</span> <span class="o">--</span><span class="n">data</span><span class="o">-</span><span class="nb">dir</span> <span class="n">data</span><span class="o">/</span><span class="n">my</span><span class="o">-</span><span class="n">blockprod</span>
                                       <span class="o">--</span><span class="n">rpc</span><span class="o">-</span><span class="n">endpoint</span> <span class="s2">&quot;127.0.0.1:8090&quot;</span>
                                                                       <span class="o">--</span><span class="n">track</span><span class="o">-</span><span class="n">account</span> <span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">1.2.282</span><span class="se">\&quot;</span><span class="s2">&quot;</span> <span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">1.2.24484</span><span class="se">\&quot;</span><span class="s2">&quot;</span> <span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">1.2.2058</span><span class="se">\&quot;</span><span class="s2">&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="max-ops-per-account">
<h3><a class="toc-backref" href="#id6">–max-ops-per-account</a><a class="headerlink" href="#max-ops-per-account" title="Permalink to this headline">¶</a></h3>
<p>Add a number of operations the node will store for each account in the network.</p>
<p>We found out that most of the blockchain size is actually history of millions of orders made by automated bot accounts in the system. The market making these accounts do, is very needed for the DEX liquidity, but is of little value for most nodes.</p>
<p>This parameter allows to go deleting the oldest operation history from all accounts. Balances and everything will still be fine, please remember this is <em>only deleting history</em>.</p>
<p>By limiting the number of operations per account to 1000 the blockchain decrease in size is more than notorious and will allow you to run nodes in reduced memory machines, can run with 4-5 gigs by using combinations around this option.</p>
<p>Reduce the number of operations for each account that the node will save in the blockchain to 100 by starting with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">programs</span><span class="o">/</span><span class="n">witness_node</span><span class="o">/</span><span class="n">witness_node</span> <span class="o">--</span><span class="n">data</span><span class="o">-</span><span class="nb">dir</span> <span class="n">data</span><span class="o">/</span><span class="n">my</span><span class="o">-</span><span class="n">blockprod</span>
                                       <span class="o">--</span><span class="n">rpc</span><span class="o">-</span><span class="n">endpoint</span> <span class="s2">&quot;127.0.0.1:8090&quot;</span>
                                                                       <span class="o">--</span><span class="nb">max</span><span class="o">-</span><span class="n">ops</span><span class="o">-</span><span class="n">per</span><span class="o">-</span><span class="n">account</span> <span class="mi">100</span>
</pre></div>
</div>
</div>
<div class="section" id="partial-operations">
<h3><a class="toc-backref" href="#id7">–partial-operations</a><a class="headerlink" href="#partial-operations" title="Permalink to this headline">¶</a></h3>
<p>Remove operation history objects.</p>
<p>BitShares-core stores operations in two different objects, the 2.9.X and the 1.11.X. they are not exactly the same but if you are removing ops with <cite>–track-account</cite> or <cite>–max-ops-per-account</cite> it makes sense that you also add this option to reduce memory usage even more.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">programs</span><span class="o">/</span><span class="n">witness_node</span><span class="o">/</span><span class="n">witness_node</span> <span class="o">--</span><span class="n">data</span><span class="o">-</span><span class="nb">dir</span> <span class="n">data</span><span class="o">/</span><span class="n">my</span><span class="o">-</span><span class="n">blockprod</span>
                                       <span class="o">--</span><span class="n">rpc</span><span class="o">-</span><span class="n">endpoint</span> <span class="s2">&quot;127.0.0.1:8090&quot;</span>
                                                                       <span class="o">--</span><span class="nb">max</span><span class="o">-</span><span class="n">ops</span><span class="o">-</span><span class="n">per</span><span class="o">-</span><span class="n">account</span> <span class="mi">100</span>
                                                                       <span class="o">--</span><span class="n">partial</span><span class="o">-</span><span class="n">operations</span> <span class="n">true</span>
</pre></div>
</div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="combinations">
<h2><a class="toc-backref" href="#id8">Combinations</a><a class="headerlink" href="#combinations" title="Permalink to this headline">¶</a></h2>
<p>Combinations that make sense are all valid and can be used to suit your needs.</p>
<p>I personally start my nodes with 1000 ops per account and partial operations:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">programs</span><span class="o">/</span><span class="n">witness_node</span><span class="o">/</span><span class="n">witness_node</span> <span class="o">--</span><span class="n">data</span><span class="o">-</span><span class="nb">dir</span> <span class="n">data</span><span class="o">/</span><span class="n">my</span><span class="o">-</span><span class="n">blockprod</span>
                                       <span class="o">--</span><span class="n">rpc</span><span class="o">-</span><span class="n">endpoint</span> <span class="s2">&quot;127.0.0.1:8090&quot;</span>
                                                                       <span class="o">--</span><span class="nb">max</span><span class="o">-</span><span class="n">ops</span><span class="o">-</span><span class="n">per</span><span class="o">-</span><span class="n">account</span> <span class="mi">1000</span>
                                                                       <span class="o">--</span><span class="n">partial</span><span class="o">-</span><span class="n">operations</span> <span class="n">true</span>
</pre></div>
</div>
<p>This will allow me to run the node with less than 5 gigs(4.820492G):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ffffffffff600000</span>      <span class="mi">4</span><span class="n">K</span> <span class="n">r</span><span class="o">-</span><span class="n">x</span><span class="o">--</span>   <span class="p">[</span> <span class="n">anon</span> <span class="p">]</span>
 <span class="n">total</span>          <span class="mi">4820492</span><span class="n">K</span>
<span class="n">root</span><span class="nd">@alfredo</span><span class="p">:</span><span class="o">~</span><span class="c1"># pmap 28685</span>
</pre></div>
</div>
<div class="section" id="special-notes">
<h3><a class="toc-backref" href="#id9">Special Notes</a><a class="headerlink" href="#special-notes" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>A new option could be <cite>untrack-account</cite>. we could identify the biggers and run a node with the account history of bots out.</li>
</ul>
<hr class="docutils" />
<dl class="docutils">
<dt>-Contributor:</dt>
<dd><ul class="first last simple">
<li>&#64;oxarbitrage</li>
</ul>
</dd>
</dl>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright BitShares Blockchain Foundation.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'',
            LANGUAGE:'en',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>