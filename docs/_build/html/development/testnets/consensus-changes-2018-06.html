

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>BSIP38: Add target collateral ratio option to short positions &mdash; BItShares Developers Portal  documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> BItShares Developers Portal
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Introduction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../intro/architectures.html">Introduction &amp; Architectures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../intro/environments.html">Development Environments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../components/components.html">System Components Elements</a></li>
</ul>
<p class="caption"><span class="caption-text">Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../integration.html">Integration Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../interaction.html">Blockchain Interaction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../testnets.html">Testnets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bsip.html">BitShares Improvement Proposal</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../supports_dev/supports.html">Support and Optimizations</a></li>
</ul>
<p class="caption"><span class="caption-text">API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../api/restrictions.html">1. API Access and Restrictions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/calls.html">2. Available Calls</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/blockchain_api.html">3. Blockchain API(s)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/wallet_api.html">4. Wallet API - Calls</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/objects_ids.html">5. Objects and IDs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/namespaces.html">6. Graphene - Namespaces</a></li>
</ul>
<p class="caption"><span class="caption-text">Guides</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../bts_guide/tutorials/index.html">Developer Guide (Tutorials)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../bts_guide/index_faq.html">Frequently Asked Questions (FAQ)</a></li>
</ul>
<p class="caption"><span class="caption-text">References</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../references/info_comunities.html">BitShares Community</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../references/info_comunities.html#bitshares-blockchain">BitShares Blockchain</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../references/tech_articles.html">Articles</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../references/githubrepo.html">BitShares Repositories</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">BItShares Developers Portal</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
      <li>BSIP38: Add target collateral ratio option to short positions</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="bsip38-add-target-collateral-ratio-option-to-short-positions">
<span id="consensus-changes-2018-06"></span><h1>BSIP38: Add target collateral ratio option to short positions<a class="headerlink" href="#bsip38-add-target-collateral-ratio-option-to-short-positions" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="table-of-contents">
<p class="topic-title first">Table of Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#motivation" id="id1">Motivation</a><ul>
<li><a class="reference internal" href="#from-abstract-of-bsip-38" id="id2">From Abstract of BSIP-38</a></li>
</ul>
</li>
<li><a class="reference internal" href="#discussion-and-development" id="id3">Discussion and Development</a></li>
<li><a class="reference internal" href="#unit-tests" id="id4">Unit Tests</a></li>
</ul>
</div>
<hr class="docutils" />
<div class="section" id="motivation">
<h2><a class="toc-backref" href="#id1">Motivation</a><a class="headerlink" href="#motivation" title="Permalink to this headline">¶</a></h2>
<div class="section" id="from-abstract-of-bsip-38">
<h3>From Abstract of <a class="reference external" href="https://github.com/bitshares/bsips/blob/master/bsip-0038.md">BSIP-38</a><a class="headerlink" href="#from-abstract-of-bsip-38" title="Permalink to this headline">¶</a></h3>
<p>When a short position is margin called, some of its collateral will be sold and some or all of its debt will be covered accordingly.</p>
<p>However, usually more collateral will be sold, in comparison to the minimum amount required to be sold to maintain the maintenance collateral ratio (MCR) requirement.</p>
<p>This BSIP proposes a protocol change to let shortes (borrowers) have control over selling how much collateral when being margin called.</p>
<p>This BSIP depends on <a class="reference external" href="https://github.com/bitshares/bsips/blob/master/bsip-0031.md">BSIP 31</a> .</p>
</div>
</div>
<div class="section" id="discussion-and-development">
<h2><a class="toc-backref" href="#id3">Discussion and Development</a><a class="headerlink" href="#discussion-and-development" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><a class="reference external" href="https://github.com/bitshares/bitshares-core/issues/834">Development Overview</a></li>
<li><a class="reference external" href="https://github.com/bitshares/bitshares-core/pull/838">Technical Discussion</a></li>
<li><a class="reference external" href="https://github.com/bitshares/bitshares-core/pull/838/files/610dbf519aa2a97523a6d753df93a00f368e4f8e">Summary of Code Changes (Merge)</a></li>
<li><a class="reference external" href="https://github.com/bitshares/bitshares-core/commit/14c9786ba9946599a6e13ccdb9928d9d152f2a7f">Summary of Code Changes (Pull Request)</a></li>
<li><a class="reference external" href="https://github.com/bitshares/bitshares-core/pull/838/commits">Individual Code Changes</a></li>
</ul>
</div>
<div class="section" id="unit-tests">
<h2><a class="toc-backref" href="#id4">Unit Tests</a><a class="headerlink" href="#unit-tests" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><a class="reference external" href="https://github.com/bitshares/bitshares-core/commit/14c9786ba9946599a6e13ccdb9928d9d152f2a7f#diff-472805f6e072745a1efe846e5a8d44f7">Changes to the test framework that imitates a live blockchain (Implementation)</a></li>
</ul>
<p>The “database fixture” is a mock blockchain/database that imitates the internal database tracked by a node on the blockchain.</p>
<p>The modification permits the optional specification by accounts on the blockchain of a target collateral ratio on a short position (call order).</p>
<hr class="docutils" />
<ul class="simple">
<li><a class="reference external" href="https://github.com/bitshares/bitshares-core/commit/14c9786ba9946599a6e13ccdb9928d9d152f2a7f#diff-39d175fc7ddf571106cb34222239fb3b">Changes to test framework that imitates a live blockchain (Header)</a></li>
</ul>
<p>This header has been modified to publicize the optional use of a target collateral ratio for short position (call orders).</p>
<hr class="docutils" />
<ul class="simple">
<li><a class="reference external" href="https://github.com/bitshares/bitshares-core/commit/14c9786ba9946599a6e13ccdb9928d9d152f2a7f#diff-0f99622d84284fc682365f4b325b624e">Test the ability to create call orders with different target collateral ratios even without submitting them to the blockchain</a></li>
</ul>
<p>This functionality that is tested is used by client software (e.g. CLI, reference wallet, Android wallets) to describe an operation (an “intent”) that will create or update a short position for an account on the blockchain. This operation should be internally consistent with itself and with the validity rules established for this operation. These intents are checked prior to submitting to an RPC node.</p>
<hr class="docutils" />
<ul class="simple">
<li><a class="reference external" href="https://github.com/bitshares/bitshares-core/commit/14c9786ba9946599a6e13ccdb9928d9d152f2a7f#diff-5984197c09fc34872620ff6206e29e35">Test of rounding of the multiplication of prices and quantities</a></li>
</ul>
<p>The functionality that is tested is used by the blockchain logic when filling orders.</p>
<hr class="docutils" />
<ul class="simple">
<li><a class="reference external" href="https://github.com/bitshares/bitshares-core/commit/14c9786ba9946599a6e13ccdb9928d9d152f2a7f#diff-6f4426832d588f71164d10b4407f2137">Test of call orders</a></li>
</ul>
<p>These tests are checking specific logic that occurs when investigating the status of existing short positions on the blockchain. The test investigates different short positions (call orders) given a particular feed price and a given match price (where matches are of a buy and sell order on the books). These different short positions have different collateral ratios some of which are not margin called, some of which need to be margin called yet have sufficient collateral, and some of which need to be margin called yet do not have sufficient collateral (i.e. black swan).</p>
<hr class="docutils" />
<ul class="simple">
<li><a class="reference external" href="https://github.com/bitshares/bitshares-core/commit/14c9786ba9946599a6e13ccdb9928d9d152f2a7f#diff-5c2422e9af6788cd1cc3e76296e1c7c4">Test of market orders</a></li>
</ul>
<p>Both tests are checking the matching of orders on the books.</p>
<p>The first test is checking the matching of a taker limit order with multiple maker call orders.</p>
<p>The second test is checking the matching of a maker limit order with multiple taker call orders.</p>
<hr class="docutils" />
<p>Contributor: &#64;taconater</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright BitShares Blockchain Foundation.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'',
            LANGUAGE:'en',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  <script type="text/javascript" src="../../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>